//
//  VulnerabilityCheckViewController.swift
//  KURSOVAYA
//
//  Created by Denis Ravkin on 03.01.2021.
//

import UIKit

class VulnerabilityCheckViewController: UIViewController {

    @IBOutlet weak var jailbreakLabel: UILabel!
    @IBOutlet weak var emulatorLabel: UILabel!
    @IBOutlet weak var debuggerLabel: UILabel!
    @IBOutlet weak var reToolsLabel: UILabel!
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        //checkJailbreak()
       // checkEmulator()
       // checkDebugger()
       // checkRETools()
     }
    override func viewDidAppear(_ animated: Bool) {
        checkJailbreak()
        checkEmulator()
        checkDebugger()
        checkRETools()
    }
     
     func checkJailbreak() {
         
         let jailbreakStatus = IOSSecuritySuite.amIJailbrokenWithFailMessage()
         
         if jailbreakStatus.jailbroken {
             print("Цей девайс використовує Jailbreak")
             print(jailbreakStatus.failMessage)
             jailbreakLabel.text = "Виявлен Jailbreak"
             jailbreakLabel.backgroundColor = UIColor.red
         } else {
             print("Jailbreak не виявлен")
             jailbreakLabel.backgroundColor = UIColor.green
             jailbreakLabel.text = "Jailbreak не виявлен"
         }
     }
    
    func checkEmulator() {
        
        let runInEmulator = IOSSecuritySuite.amIRunInEmulator() ? true : false
        
        if runInEmulator {
            print("Виявлен емулятор")
            emulatorLabel.backgroundColor = UIColor.red
            emulatorLabel.text = "Виявлен эмулятор"
        } else {
            print("Не виявлен емулятор")
            emulatorLabel.backgroundColor = UIColor.green
            emulatorLabel.text = "Емулятор не виявлен"
        }
        
    }
    
    func checkDebugger() {
        
        let amIDebugged = IOSSecuritySuite.amIDebugged() ? true : false
        
        if amIDebugged {
            print("Виявлен дебагер")
            debuggerLabel.backgroundColor = UIColor.red
            debuggerLabel.text = "Виявлен дебагер"
        } else {
            print("Дебагер не виявлен")
            debuggerLabel.backgroundColor = UIColor.green
            debuggerLabel.text = "Дебагер не виявлен"
        }
        
    }
    
    func checkRETools() {
        
        let amIReverseEngineered = IOSSecuritySuite.amIReverseEngineered() ? true : false
        
        if amIReverseEngineered {
            print("Виявлені RE Tools")
            reToolsLabel.backgroundColor = UIColor.red
            reToolsLabel.text = "Виявлені RE Tools"
        } else {
            print("RE tools не виявлені")
            reToolsLabel.backgroundColor = UIColor.green
            reToolsLabel.text = "RE tools не виявлені"
        }
        
    }

}
